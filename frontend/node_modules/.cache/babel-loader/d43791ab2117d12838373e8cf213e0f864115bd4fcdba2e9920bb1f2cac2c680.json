{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hcadi\\\\Desktop\\\\CIS440 Work\\\\group project\\\\CIS440Team3\\\\frontend\\\\src\\\\components\\\\recipedetail.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useContext } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport { AuthContext } from '../context/AuthContext'; // Import the AuthContext\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction RecipeDetail() {\n  _s();\n  const {\n    id\n  } = useParams(); // Get the recipe ID from the URL\n  const [recipe, setRecipe] = useState(null); // State for storing the recipe data\n  const [isSaved, setIsSaved] = useState(false); // Track if the recipe is already saved\n  const {\n    authToken,\n    setAuthToken\n  } = useContext(AuthContext); // Get authToken from context\n  const navigate = useNavigate(); // To navigate programmatically\n\n  // Fetch recipe details when the component mounts or when the `id` or `authToken` changes\n  useEffect(() => {\n    if (!authToken) {\n      navigate('/login'); // Redirect to login if there's no authToken\n      return;\n    }\n    fetch(`/api/recipe/${id}`, {\n      headers: {\n        Authorization: `Bearer ${authToken}` // Include the authToken in the Authorization header\n      }\n    }).then(res => {\n      if (res.status === 401 || res.status === 403) {\n        setAuthToken(null); // Clear the token if unauthorized\n        navigate('/login'); // Redirect to login page\n        throw new Error('Unauthorized');\n      }\n      if (!res.ok) throw new Error('Failed to fetch recipe');\n      return res.json();\n    }).then(data => setRecipe(data)) // Update the state with the recipe data\n    .catch(err => console.error('Error:', err));\n  }, [id, authToken, navigate, setAuthToken]); // Dependency array\n\n  // Function to save the recipe to the user's saved recipes\n  const saveRecipe = async () => {\n    try {\n      const response = await fetch(`/api/recipe/${id}/save`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${authToken}` // Include the authToken in the Authorization header\n        }\n      });\n      if (!response.ok) {\n        throw new Error('Failed to save recipe');\n      }\n      const data = await response.json();\n      console.log('Recipe saved:', data);\n      setIsSaved(true); // Update the UI to reflect that the recipe is saved\n    } catch (error) {\n      console.error('Error saving recipe:', error);\n    }\n  };\n  if (!recipe) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 23\n  }, this); // Show loading state while fetching\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Link, {\n      to: \"/\",\n      children: \"\\u2190 Back to Search\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: recipe.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      src: recipe.image,\n      alt: recipe.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Ingredients:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: recipe.extendedIngredients.map(ing => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: ing.original\n      }, ing.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Instructions:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), recipe.instructions ? /*#__PURE__*/_jsxDEV(\"div\", {\n      dangerouslySetInnerHTML: {\n        __html: recipe.instructions\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"No instructions available.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: saveRecipe,\n      disabled: isSaved,\n      children: [isSaved ? 'Recipe Saved' : 'Save Recipe', \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n}\n_s(RecipeDetail, \"peE3EcCuZBSWyJQuZPcqGlwJbGg=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = RecipeDetail;\nexport default RecipeDetail;\nvar _c;\n$RefreshReg$(_c, \"RecipeDetail\");","map":{"version":3,"names":["React","useEffect","useState","useContext","useParams","Link","useNavigate","AuthContext","jsxDEV","_jsxDEV","RecipeDetail","_s","id","recipe","setRecipe","isSaved","setIsSaved","authToken","setAuthToken","navigate","fetch","headers","Authorization","then","res","status","Error","ok","json","data","catch","err","console","error","saveRecipe","response","method","log","children","fileName","_jsxFileName","lineNumber","columnNumber","to","title","src","image","alt","extendedIngredients","map","ing","original","instructions","dangerouslySetInnerHTML","__html","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/Users/hcadi/Desktop/CIS440 Work/group project/CIS440Team3/frontend/src/components/recipedetail.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\r\nimport { useParams, Link, useNavigate } from 'react-router-dom';\r\nimport { AuthContext } from '../context/AuthContext'; // Import the AuthContext\r\n\r\nfunction RecipeDetail() {\r\n  const { id } = useParams(); // Get the recipe ID from the URL\r\n  const [recipe, setRecipe] = useState(null); // State for storing the recipe data\r\n  const [isSaved, setIsSaved] = useState(false); // Track if the recipe is already saved\r\n  const { authToken, setAuthToken } = useContext(AuthContext); // Get authToken from context\r\n  const navigate = useNavigate(); // To navigate programmatically\r\n\r\n  // Fetch recipe details when the component mounts or when the `id` or `authToken` changes\r\n  useEffect(() => {\r\n    if (!authToken) {\r\n      navigate('/login'); // Redirect to login if there's no authToken\r\n      return;\r\n    }\r\n\r\n    fetch(`/api/recipe/${id}`, {\r\n      headers: {\r\n        Authorization: `Bearer ${authToken}`, // Include the authToken in the Authorization header\r\n      },\r\n    })\r\n      .then((res) => {\r\n        if (res.status === 401 || res.status === 403) {\r\n          setAuthToken(null); // Clear the token if unauthorized\r\n          navigate('/login'); // Redirect to login page\r\n          throw new Error('Unauthorized');\r\n        }\r\n        if (!res.ok) throw new Error('Failed to fetch recipe');\r\n        return res.json();\r\n      })\r\n      .then((data) => setRecipe(data)) // Update the state with the recipe data\r\n      .catch((err) => console.error('Error:', err));\r\n  }, [id, authToken, navigate, setAuthToken]); // Dependency array\r\n\r\n  // Function to save the recipe to the user's saved recipes\r\n  const saveRecipe = async () => {\r\n    try {\r\n      const response = await fetch(`/api/recipe/${id}/save`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${authToken}`, // Include the authToken in the Authorization header\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to save recipe');\r\n      }\r\n\r\n      const data = await response.json();\r\n      console.log('Recipe saved:', data);\r\n      setIsSaved(true); // Update the UI to reflect that the recipe is saved\r\n    } catch (error) {\r\n      console.error('Error saving recipe:', error);\r\n    }\r\n  };\r\n\r\n  if (!recipe) return <div>Loading...</div>; // Show loading state while fetching\r\n\r\n  return (\r\n    <div>\r\n      <Link to=\"/\">‚Üê Back to Search</Link>\r\n      <h2>{recipe.title}</h2>\r\n      <img src={recipe.image} alt={recipe.title} />\r\n      <h3>Ingredients:</h3>\r\n      <ul>\r\n        {recipe.extendedIngredients.map((ing) => (\r\n          <li key={ing.id}>{ing.original}</li>\r\n        ))}\r\n      </ul>\r\n      <h3>Instructions:</h3>\r\n      {recipe.instructions ? (\r\n        <div dangerouslySetInnerHTML={{ __html: recipe.instructions }} />\r\n      ) : (\r\n        <p>No instructions available.</p>\r\n      )}\r\n      \r\n      {/* Save Button */}\r\n      <button onClick={saveRecipe} disabled={isSaved}>\r\n        {isSaved ? 'Recipe Saved' : 'Save Recipe'} {/* Change text based on saved state */}\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default RecipeDetail;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}